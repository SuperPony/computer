# Shell 脚本语法

# 变量

Shell 脚本变量的定义格式为 `name=val`，需要的注意的是：

- 变量名只能是字母、数字、下划线，首个字符不能以数字开头；
- `=` 左右不能有空格；
- 不能使用 bash 里的保留关键词。

使用变量有两个方式，分别为：

- `$name`;
- `${name}` 推荐使用这种，当变量与字符混合时，更容易区分。

## 只读变量

`readonly` 关键词用于修饰变量只读，在变量初始化定义后，无法再次修改变量的值。

## 删除变量

`unset` 关键词用于删除指定变量，变量删除后无法再次使用，该关键词无法删除只读变量。

# 数据类型

## 字符串

Shell 中字符串由单/双引号包裹，单引号包裹的字符串会原样输出，双引号包括会识别变量以及转义字符。

识别字符串长度 `${#name}`。

## 数组

Shell 中数组只支持一维数组，且不限定数组的长度以及每个元素不强制保持一致。

定义数组 `name=(el1 el2... eln)` 注意，元素之间以空格分割，获取指定下标数组元素 `${name[index]}`，获取全部元素 `${name[@]}`,获取数组长度 `${#name[n]}`。

在 Shell 中，可以通过 `declare -A name=(["key"=val ...]);` 的格式来定义关联数组，其中 `declare -A` 是声明关联数组的命令，获取指定下标元素的格式为 `name["key"]`，获取全部 key 的方式为 `${!name[@]}`。

## 数字

即正常数字。

# 执行参数

在执行 Shell 脚本时，可以携带参数，在脚本内通过 `$n` 进行获取，`n` 是一个整数，对应传入的参数位数，以 1 开始。

`$ demo.sh hello`

```sh
#!/bin/bash

echo $1; # hello
```

另外，在 Shell 中，还有几个特殊字符用于处理参数：

| 特殊字符 |                             说明                             |
| :------: | :----------------------------------------------------------: |
|    $#    |                     传递至脚本的参数个数                     |
|   $\*    |            以一个蛋字符串显示所有向脚本传入的参数            |
|    $$    |                    当前脚本运行的进程 ID                     |
|    $!    |                  后台运行的最后一个进程 ID                   |
|    $@    |  与 $\* 类似，但是使用时加引号，并在每个引号中返回每个参数   |
|    $-    |        显示 Shell 使用的当前选项，与 set 命令功能相同        |
|    $?    | 显示最后命令的退出状态。0 表示没有错误，其他任何值表明有错误 |

# 流程控制

在 Shell 中，流程控制代码块不可为空，因此如果 else 语句中没有内容，就不要写 else；具体格式如下

```sh
if condition
then
# do something...
else if condition2
then
# do something...
else
# do something...
fi
```
